//BULLS & COWS : Developed by Nitin Pai (nitinz@usa.net)
//
//OBJECT OF THE GAME :
//	The object of the game is to find out the 4-digit number that was
//	randomly generated by the computer. You have 10 tries in which to do
//	that. Enter ONLY 4-digit numbers (which contais no 0s & no numbers are
//	repeated. If there is a common digit between the number you entered &
//	the random number, but in different positions, you get a cow! If the
//	positions are thye same you get a Bull!
//	Best Of Luck!!!


#include <iostream.h>
#include <graphics.h>
#include <stdlib.h>
#include <string.h>
#include <conio.h>
#include <stdio.h>

//Function declaration
void drawpoly(int ,int ,int ,int ,int ,int );
void finalscreen(void);

void main(void)
{
	//Varaible Declaration
	int digit1[4],digit2[4],guess[15],i,j,num1,num2,b,c,tries=0, poly[8];
	int gdriver = DETECT,gmode,errorcode;
	char choice, temp[10],temp1[10];

	do
	{
		initgraph(&gdriver,&gmode,"");

		errorcode = graphresult();		//Error Check
		if(errorcode != 0)
		{
			cout << "Graphics Initialization Error\n";
			cout << "Sorry you cant play Bulls & Cows!\n";
			cout << "Copy the graphics files (*.bgi,*.chr) to the same directory\n";
			cout << "Press any key to continue...";
			getch();
			exit(1);
		}

		setbkcolor(BLACK);

	//Draw Frames...
		//Full Frame
		drawpoly(1,1,638,478,EMPTY_FILL,BLACK);

		//Title Frame
		drawpoly(1,1,638,55,SOLID_FILL,LIGHTCYAN);

		//Mathosphoria Frame
		drawpoly(1,55,60,478,SOLID_FILL,YELLOW);

		//So Far Frame
		drawpoly(60,230,349,440,EMPTY_FILL,BLUE);

		//Rules Frame
		drawpoly(349,260,638,440,EMPTY_FILL,GREEN);

		//Comment Frame
		drawpoly(349,55,638,130,EMPTY_FILL,RED);

		//Comment-Bottom Frame
		drawpoly(349,230,638,260,EMPTY_FILL,RED);

		//Status Frame
		drawpoly(1,1,638,478,EMPTY_FILL,DARKGRAY);

		line(60,130,349,130);	//Frame1:H#1
		line(60,230,349,230);	//Frame1:H#2
		line(100,55,100,230);	//Frame1:V#1

		setcolor(BLACK);
		settextstyle(TRIPLEX_FONT,HORIZ_DIR,5);
		outtextxy(220,2,"Bulls & Cows");

		settextstyle(TRIPLEX_FONT,VERT_DIR,4);
		outtextxy(10,120,"Mathsophoria 2000");

		setcolor(WHITE);
		settextstyle(SANS_SERIF_FONT,VERT_DIR,4);
		outtextxy(55,55,"Input");
		outtextxy(55,128,"Output");

		settextstyle(SMALL_FONT,HORIZ_DIR,5);
		outtextxy(430,235,"Enter '0' to Exit!");

		outtextxy(145,230,"Story So Far....");
		outtextxy(80,245,"Try");
		outtextxy(130,245,"Number");
		outtextxy(230,245,"Bulls");
		outtextxy(295,245,"Cows");

		outtextxy(472,265,"RULES");
		outtextxy(354,285,"1. Enter ONLY 4 digit numbers");
		outtextxy(354,315,"2. Press 'Enter' after entering");
		outtextxy(380,335,"each number");
		outtextxy(354,365,"3. Do NOT enter 0s");
		outtextxy(354,390,"4. Do NOT repeat numbers");
		outtextxy(354,415,"5. Use your Mind!");

	//Generate Random Number
		randomize();
		do
		{
			digit1[0] = random(10);
			do
			{
				digit1[1] = random(10);
				do
				{
					digit1[2] = random(10);
					do
					{
						digit1[3] = random(10);
					}while((digit1[3] == digit1[2]) || (digit1[3] == digit1[1]) || (digit1[3] == digit1[0]) || (digit1[3] == 0));
				}while((digit1[2] == digit1[1]) || (digit1[2] == digit1[0]) || (digit1[2] == digit1[3]) || (digit1[2] == 0));
			}while((digit1[1] == digit1[0]) || (digit1[1] == digit1[2]) || (digit1[1] == digit1[3]) || (digit1[1] == 0));
		}while((digit1[0] == digit1[1]) || (digit1[0] == digit1[2]) || (digit1[0] == digit1[3]) || (digit1[0] == 0));

		do
		{
			settextstyle(SMALL_FONT,HORIZ_DIR,5);

			if(tries > 0)
			{
				itoa(tries,temp,10);
				outtextxy(87,255+(tries-1)*12,temp);
				itoa(guess[tries-1],temp,10);
				outtextxy(135,255+(tries-1)*12,temp);
				itoa(b,temp,10);
				outtextxy(245,255+(tries-1)*12,temp);
				itoa(c,temp,10);
				outtextxy(310,255+(tries-1)*12,temp);
			}

			settextstyle(SANS_SERIF_FONT,HORIZ_DIR,4);
			outtextxy(65,435,"Enter a Number");

			gotoxy(16 , 6);		cout << "Enter a number :      ";
			gotoxy(33 , 6);		cin >> num2;

			if((num2 == 0) || (num2 == 1))
				break;

			//Split Number into seperate Digits
			digit2[0] = num2 / 1000;
			digit2[1] = num2 / 100;	  			digit2[1] = digit2[1] % 10;
			digit2[2] = num2 / 10;          	digit2[2] = digit2[2] % 10;
			digit2[3] = num2 % 10;

			settextstyle(SMALL_FONT,HORIZ_DIR,8);

			if((digit2[0] == 0) || (digit2[1] == 0) || (digit2[2] == 0) || (digit2[3] == 0))
			{
				drawpoly(100,130,638,230,SOLID_FILL,DARKGRAY);
				outtextxy(111,165,"Do not enter 0s");
				continue;
			}

			for(i=0 ; i<4 ; i++)
				for(j=i+1 ; j<4 ; j++)
					if(digit2[i] == digit2[j])
					{
						drawpoly(100,130,638,230,SOLID_FILL,DARKGRAY);
						outtextxy(111,165,"Do not repeat Numbers");
						continue;
					}

			b = c = 0;
			guess[tries] = num2;
			tries++;

			for(i=0 ; i<4 ; i++)
			{
				if(digit1[i] == digit2[i])
					b++;
				for(j=0 ; j<4 ; j++)
					if((digit1[i] == digit2[j]) && (i != j))
						c++;
			}

			if((b != 4) && (tries == 10))
				break;

		}while(b < 4);

		if(b == 4)		//Win
		{
			itoa(tries,temp,10);
			drawpoly(349,55,638,130,EMPTY_FILL,RED);        //Comment Frame
			drawpoly(100,130,638,230,SOLID_FILL,DARKGRAY);  //Status Frame
			settextstyle(TRIPLEX_FONT,HORIZ_DIR,2);

			outtextxy(440,90,"Congrats!");
			outtextxy(111,165,"You did it in ");
			outtextxy(260,165,temp);
			if(tries < 2)
				outtextxy(280,165," try!");
			else
				outtextxy(280,165," tries!");
		}
		else			//Lose
		{
			drawpoly(349,55,638,130,EMPTY_FILL,RED);		//Comment Frame
			drawpoly(100,130,638,230,SOLID_FILL,DARKGRAY);	//Status Frame

			settextstyle(TRIPLEX_FONT,HORIZ_DIR,2);

			itoa(digit1[0],temp1,10);
			strcpy(temp,temp1);
			for(i=1 ; i<4 ; i++)
			{
				itoa(digit1[i],temp1,10);
				strcat(temp,temp1);
			}

			if(tries == 10)
				outtextxy(390,60,"Sorry Turns Up!");
			outtextxy(375,90,"Better Luck Next Time!");
			outtextxy(111,165,"The Number was :");
			outtextxy(300,165,temp);

			//Easter Egg
			if(num2 == 1)
				outtextxy(111,195,"Developed by Nitin");
		}

		drawpoly(60,440,638,478,SOLID_FILL,DARKGRAY);		//Status Frame

		settextstyle(SANS_SERIF_FONT,HORIZ_DIR,4);
		outtextxy(65,435,"Play Again (Y/N) :");
		choice = getche();
	}while((choice == 'y') || (choice == 'Y'));

	finalscreen();
	closegraph();
}

void drawpoly(int c1,int c2,int c3,int c4,int f,int c)
{
	int poly[8];
	poly[0] = c1;	poly[1] = c2;			poly[2] = c3;	poly[3] = c2;
	poly[4] = c3;	poly[5] = c4;			poly[6] = c1;	poly[7] = c4;
	setfillstyle(f,c);
	fillpoly(4,poly);
}

void finalscreen(void)
{
	cleardevice();
	line(1,1,639,1);
	line(1,1,1,479);
	line(1,479,639,479);
	line(639,1,639,479);
	line(1,125,639,125);
	line(1,360,639,360);
	line(1,435,639,435);
	line(320,125,320,175);
	line(1,175,639,175);

	settextstyle(SMALL_FONT,HORIZ_DIR,5);
	outtextxy(25,25,"This Software is FREEWARE. U R encouraged 2 distribute it 2 others.");
	outtextxy(25,50,"Please REGISTER by sending an e-mail 2 me.");
	outtextxy(25,75,"Register NOW 2 continue receiving Softwares/Games developed in the future!");
	settextstyle(SMALL_FONT,HORIZ_DIR,6);
	outtextxy(25,125,"Developed by Nitin");
	outtextxy(25,150,"(D.G.Vaishnav College)");
	setcolor(RED);
	outtextxy(25,200,"Comments & Suggestions welcome!");
	outtextxy(25,225,"Want 2 develop new Softwares/Games 4 FREE?");
	outtextxy(25,275,"Contact me at :");
	outtextxy(50,300,"E-Mail : nitinz@usa.net");
	outtextxy(50,325,"ICQ#   : 33636427");
	setcolor(YELLOW);
	outtextxy(405,125,"SMILE a lot.");
	outtextxy(405,150,"It costs nothing.");
	outtextxy(350,135,":-)");
	outtextxy(580,135,":-)");
	outtextxy(25,375,"E-mail me with 'MAILING LIST' as Subject 2 be informed");
	outtextxy(25,400,"of NEW RELEASES!");
	setcolor(WHITE);
	outtextxy(25,450,"Press any key to continue.....");
	getch();
}